## JPA

---

>김영한님의 `자바 ORM 표준 JPA 프로그래밍`과 `인프런 JPA` 강의를 들으면서 실제 현업에 엄청난 도움을 받았다.<br>
> JPA 를 처음접한다면 책과 동영상 강의를 함께 보면 더 좋을것 같다.

### JPA 는 자바 진영의 ORM 기술표준이다. 
쉽게 말해 JPA 는 JPA를 사용하기 위한 인터페이스를 모아둔 것이다.

> <strong>ORM</strong> 은 Object Relational Mapping의 약자로<br> 
> 말그대로 객체와 관계형 데이터베이스의 데이터를 자동으로 매핑해주는 것을 말한다.
> 

그렇다면 JPA 를 사용하였을때 우리가 얻어갈수 있는 장점은 뭐가 있을까?

 - JPA 를 이용하여 개발을 하게되면 SQL을 직접 작성하지 않고 어떠한 SQL이 실행될지 생각만 하면 된다.
   (SQL이 중요하지 않다는것은 아니다.)
 - 객체 중심으로 개발하니 생산성과 유지보수가 좋아지고 테스트를 작성하기에도 편리해진다.
 - 데이터베이스를 MySQL을 사용하다가 다른 데이터베이스로 변경하게 되어도 코드를 수정하기보다는 옵션값으로 데이터베이스를
   간단하게 변경할 수 있다.


---

### JPA를 이용하여 어떻게 CRUD를 하는가

 ###\- 저장 (Persist)
```java
// persist()메소드에 파라미터로 Entity를 넣게 되면, JPA가 객체와 매핑정보를 확인하고 INSERT SQL을 
// 생성하여 데이터베이스에게 전달한다  

jpa.persist(person);
```

 ### \- 조회 (Find)
```java
// find() 메소드의 파라미터에 해당하는 class와, @Id (PK)를 넣게되면 
// JPA는 객체와 매핑정보를 보고 1L에 해당하는 Person 객체를 생성하여 반환한다.

Long personId = 1L;
Person person = jpa.find(Person.class, personId);
```

 ### \- 수정
```java
// Update는 어떻게 해야할까, JPA 는 수정에 대한 메소드는 제공하지 않습니다.
// 다만 다만 객체를 조회한다음 영속상태에서 값을 변경하게 되면 트랜잭션을 커밋할 때 데이터베이스에
// 적절한 Update SQL이 생성되어 전달됩니다.
Long personId = 1L;
Person person = jpa.find(Person.class, personId);
person.setName("최윤진");
```

 ### \- 연관된 객체의 조회
```java
// 실제로 코드를 짜게 되면 Person과 Team은 연관관계를 맺고 있을것이다.
// 이럴때 JPA에서 연관된 객체를 가져오기 위해서는 해당 프로퍼티를 가져오기만 하면된다.
// 자세한 내용은 뒤에 포스팅하겠습니다.
Person person = jpa.find(Person.class, 1L);
Team team = person.getTeam();
```

---

## 그렇다면 왜 JPA 를 사용해야 하는가?

#### 1. 생산성
> JPA 를 사용하면 Java Collection에 객체를 저장하듯이 JPA에게 저장할 객체를 전달하면된다. 반복적이고 지루한 SQL작성은
> JPA가 대신해준다 따라서 객체설계 중심으로 역전시킬 수 있다.

#### 2. 유지보수 
> SQL을 직접 다루면 Entity를 수정해달라는 요청이 올때마다 해당하는 모든 SQL을 찾아 수정해야합니다.
> 이러한 작업을 JPA는 대신 처리해주기 때문에 필드를 추가하거나, 삭제, 수정하여도 수정해야할 코드가 줄어든다.

#### 3. 패러다임의 불일치 해결 
>JPA는 상속, 연관관계, 객체 그래프 탐색, 비교하기와 같은 패러다임의 불일치 문제를 해결해준다.
> 

#### 4. 성능
> JPA는 애플리케이션과 데이터베이스 사이에서 다양한 성능 최적화 기회를 제공한다. <br> 
> 뒷 내용에서 나오겠지만 JPA에서는 1차캐시를 통해 성능 최적화를 할 수 있게 해준다.

#### 5. 데이터 접근 추상화와 벤더 독립성
> 같은 기능도 벤더마다 사용법이 다른 경우가 많다. <br>
> 대표적으로 벤더사마다 페이징 처리 방식이 모두 달라 사용법을 각각 배워야한다 <br>
> JPA는 벤더사에게 추상화된 접근 계층을 제공하여 특정 데이터베이스 기술에 종속되지 않도록 해준다.

---



