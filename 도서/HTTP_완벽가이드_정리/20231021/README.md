# 클라이언트 식별과 쿠키

> 해당 내용에서는 서버가 통신하는 대상을 식별하는데 사용하는 기술에 대해 본다.

---

## 개별 접촉

HTTP는 익명으로 사용하며 상태가 없고, 요청과 응답으로 통신하는 프로토콜이다. 따라서 요청을 처리하고나서 응답을 
클라이언트로 전송하게 된다. 

서버는 요청을 보낸 사용자에 대해서 식별하기 위해 약간의정보를 이용할 수 있다.

1. 개별인사 : 사용자에게 특화된 메시지나 페이지 내용을 만든다.
2. 사용자 맞춤 추천 : 사용자가 좋아할만한 내용에 대한 컨텐츠를 추천한다. 특정 이벤트에 대한 컨텐츠를 제시할수도 있다.
3. 저장된 사용자 정보 : 복잡한 주소라던지, 특정한 정보들을 매번 기입하는것은 사용자들이 싫어한다. 따라서 사용자가 편하게 사용 할 수 있게끔 저장된 사용자 정보를 사용한다.

4. 세션 추적 : HTTP트랜잭션은 상태가 없다. 많은 웹사이트에서는 사용자가 사이트와 상호작용할 수 있도록 사용자의 상태를 남긴다. 이러한 상태를 유지하기 위해서는 사용자에게서 오는 HTTP트랜잭션에 대해서 식별할 방법이 필요하다.

---


## HTTP 헤더 

사용자에 대한 정보를 전달하는 HTTP헤더는 대략적으로 다음과 같다

`From` - 요청 타입이며 사용자의 이메일 주소를 의미한다.<br>
> From 의 경우 사용자의 이메일을 각각 다르게 가지고있는것이 이상적이지만, 악의적으로 이메일을 모아서 스팸을 발송하는 문제가있어
> 헤더를 보내는 브라우저는 많지 않다. 다만 크롤링봇이나 데이터를 수집하는 봇들은 본의아니게 문제를 발생시킬 수 있어 웹사이트에게 From 헤더를 통해 연락가능한 이메일을 제공한다.

<br>

`User-Agent` - 요청 타입이며 사용자의 브라우저 정보를 담고 있다. <br>
> 사용자가 사용하고있는 브라우저의 이름과 버전 정보, 어떤 경우에는 운영체제에 대한 정보까지 서버에게 알려준다.

<br>

`Referer` - 요청 타입이며, 사용자가 현재 링크를 타고온 근원 페이지를 의미한다 <br>
> 사용자가 현재 페이지로 유입하게 한 웹페이지의 URL을 가리킨다. 해당 헤더만으로 사용자를 식별할 수는 없지만
> 사용자가 이전에 어떠한 페이지를 방문하였는지 알려준다.

`Authorization` - 요청 타입이며 사용자의 이름과 비밀번호를 의미 <br>
`Client-ip` - 확장(요청) 타입이며, 클라이언트의 IP주소 <br>
`X-Forwarded-For` - 확장(요청) 타입이며, 클라이언트의 IP주소 <br>
`Cookie` - 확장(요청) 타입이며, 서버가 생성한 ID정보  <br>

---

## 클라이언트 IP 주소 

초기 웹에서는 식별에 클라이언트 IP주소를 사용하고자 하였다. 해당 방식은 사용자의 확실한 IP주소를 가지고 있고, 좀처럼 혹은 아예 변경되지 않기 때문에
요청마다 클라이언트의 IP를 알 수 있따면 문제 없이 동작한다.
(IP는 서버에서 TCP케넥션의 Ip주소를 알아낼 수 있다.)

다만 해당 방식은 다음과 같은 약점을 가지고 있다.

- 클라이언트 IP주소는 사용자가 아닌 해당 컴퓨터를 가리키기 때문에 여러 사용자가 해당 컴퓨터를 공용으로 사용하게 된다면 특정 사용자를 식별할 수 없다.
- 인터넷 서비스 제공자는 사용자가 로그인하면 동적IP를 할당한다 따라서 매번 다른 주소를 받기 때문에 사용자라를 IP주소로 식별할 수 없다.
- 보안을 강화하고 부족한 주소를 관리하기위해 NAT 방화벽을 통해 인터넷을 사용한다. 해당 NAT방식은 실제 IP주소를 방화벽 뒤로 숨기고 실제 IP주소를 내부에서 사용하는 하나의 방화벽 IP주소로 변환하기 때문에 식별하기 힘들다.
- 보통 HTTP 프록시와 게이트웨이는 원 서버에 새로운 TCP연결을 한다. 따라서 웹서버에서는 실제 클라이언트의 IP가 아닌 프록시 또는 게이트웨이의 IP주소를 바라본다. 일부 프록시는 IP주소를 보존하기위해 확장 헤더를 추가하여 해당 문제를해결하려고 하였다. 다만 모든 프록시가 지원하지는 않는다.

---

